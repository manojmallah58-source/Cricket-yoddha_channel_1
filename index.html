<script>
    document.addEventListener('DOMContentLoaded', async () => {
      shaka.polyfill.installAll();
  
      if (!shaka.Player.isBrowserSupported()) {
        console.error('Browser not supported');
        return;
      }
  
      const video = document.querySelector('video');
      const player = new shaka.Player();
      await player.attach(video);
  
      const container = document.querySelector('.shaka-video-container');
      const ui = new shaka.ui.Overlay(player, container, video);
  
      ui.configure({
        controlPanelElements: [
          'play_pause', 'time_and_duration', 'mute', 'volume',
          'spacer', 'language', 'captions', 'picture_in_picture',
          'quality', 'fullscreen'
        ],
        volumeBarColors: {
          base: 'rgba(255, 192, 203, 0.3)',
          level: 'rgb(255, 105, 180)'
        },
        seekBarColors: {
          base: 'rgba(255, 255, 0, 0.3)',
          buffered: 'rgba(255, 255, 0, 0.6)',
          played: 'rgb(255, 255, 0)'
        }
      });
  
      // ⭐ UPDATED DRM Key
      let drmConfig = {
        clearKeys: {
          // Key ID (fe7718fbb3fb4ba78c07cc0f578744e6) : Content Key (624e24b1843b459fab0a949609416f0d)
          "fe7718fbb3fb4ba78c07cc0f578744e6": "624e24b1843b459fab0a949609416f0d"
        }
      };
  
      // ⭐ UPDATED Stream URL (URL-decoded for clarity, but includes the required query parameters)
      let streamUrl = "https://livetv-push.hotstar.com/dash/live/2002466/sshindiwv/master.mpd?|cookie=hdntl=exp=1765511244~acl=*sshindi*~id=d0a748e855d3ddc77cf92f5a6dc0bd9f~data=hdntl~hmac=725a4e89e0c9089e4ca0ef925d32fc612e7e9c6a8d7b6cce8596ac0af2fd68a0&User-agent=Hotstar;in.startv.hotstar/24.11.04.3.10658 (Android/15)&referer=https://www.hotstar.com/&origin=https://www.hotstar.com&drmScheme=clearkey&drmLicense=fe7718fbb3fb4ba78c07cc0f578744e6:624e24b1843b459fab0a949609416f0d";
  
      // ⭐ ADDED CONFIGURATION FOR HTTP HEADERS (Crucial for Hotstar streams)
      player.configure({
        drm: drmConfig,
        // Set custom headers for manifest and segment requests
        http: {
          headers: {
            'User-Agent': 'Hotstar;in.startv.hotstar/24.11.04.3.10658 (Android/15)',
            'Referer': 'https://www.hotstar.com/',
            'Origin': 'https://www.hotstar.com'
          }
        },
        streaming: {
          lowLatencyMode: true,
          bufferingGoal: 15,
          rebufferingGoal: 2,
          bufferBehind: 15,
          retryParameters: {
            timeout: 10000,
            maxAttempts: 5,
            baseDelay: 300,
            backoffFactor: 1.2
          },
          segmentRequestTimeout: 8000,
          segmentPrefetchLimit: 2,
          useNativeHlsOnSafari: true
        },
        manifest: {
          retryParameters: {
            timeout: 8000,
            maxAttempts: 3
          }
        }
      });
  
      player.addEventListener('error', (event) => {
        console.error('Shaka Player Error:', event.detail);
      });
  
      try {
        await player.load(streamUrl);
        console.log("Stream loaded successfully");
      } catch (error) {
        console.error('Load error:', error);
      }
    });
  </script>


